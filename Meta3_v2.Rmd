---
title: "Meta 3 - ANOVA 3 "
output: 
  html_notebook: 
    toc: yes
    toc_float:
      collapsed: false
    number_sections: true
---

# Dependencies ---------------

```{r Libraries}
#library(readr)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("dplyr")
library(dplyr)
#install.packages("car")
library(car)
#install.packages("scatterplot3d", dependencies = TRUE)
library(scatterplot3d)
#install.packages("rgl")
library(rgl)
options(rgl.printRglwidget = TRUE)
library("ggpubr")
require("dplyr")
```

# Dinic

```{r Load data set}
df <- read.csv(file = "results_tests_dinic.csv", header=TRUE)
df$alg = factor(df$alg)
df$n = factor(df$n)
df$p = factor(df$p)
```

## Analysis ---------------

```{r Summary of data}
summary(df)
```
## Visualizing

```{r Interactions}
ggline(df, x = "p", y = "time", color = "n", add = c("mean_se"))
ggline(df, x = "n", y = "time", color = "p", add = c("mean_se"))
```

```{r Plots}
ggplot(df, aes(x = time, color = n, fill = n)) + geom_density(alpha = 0.1)
ggboxplot(df, x = "n", y = "time", fill = "n", add = "jitter")
ggboxplot(df, x = "p", y = "time", fill = "p", add = "jitter")
ggboxplot(df, x = "n", y = "time", color = "p", add = "jitter")
ggboxplot(df, x = "p", y = "time", color = "n", add = "jitter")
```

## ANOVA ---------------

```{r ANOVA}
res.aov1 <- aov(time ~ p * n, data = df)
summary(res.aov1)
```

## Normalidade plots ---------------

```{r Normalidade dos plots}
plot(res.aov1, 1)

res <- res.aov1$residuals

hist(res, main="Histogram of residuals", xlab="Residuals")

qqnorm(res)
qqline(res)

leveneTest(time ~ interaction(n, p), data=df)
```

## Post HOC Analysis ---------------

```{r Post HOC}
TukeyHSD(res.aov1)
plot(TukeyHSD(res.aov1, conf.level=.95), las = 2)
```

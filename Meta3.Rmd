---
title: "Meta 3 - ANOVA 3 "
output: 
  html_notebook: 
    toc: yes
    toc_float:
      collapsed: false
    number_sections: true
---

# Dependencies ---------------

```{r Libraries}
#library(readr)
install.packages("ggplot2")
library(ggplot2)
install.packages("dplyr")
library(dplyr)
install.packages("car")
library(car)
#install.packages("scatterplot3d", dependencies = TRUE)
library(scatterplot3d)
#install.packages("rgl")
library(rgl)
options(rgl.printRglwidget = TRUE)
```

```{r Load data set}
df <- read.csv(file = "/Users/tiagodelgado/mei-proj/resultsMei_v2.csv", header=TRUE)
```

## Analysis ---------------

```{r Summary of data}
summary(df)
```

# ANOVA 3 ---------------

# Factors ---------------

```{r Factors}
n_vert <- factor(df$n_vert,levels = c(2000,3000,5000,9000))

prob <- factor(df$prob,levels = c(0.3,0.5,0.7))

algo <- factor(df$alg,levels = c("Dinic","EK","MPM"))

head(df)

str(df)

table(df$alg, df$prob, df$n_vert, df$time)

library("ggpubr")
ggboxplot(df, x = "n_vert", y = "algo", color = "prob",
          palette = c("#00AFBB", "#E7B800"))
```


```{r ANOVA 3 }
res.aov1 <- aov(df$time~df$alg*df$prob*df$n_vert, data = df)
summary(res.aov1)
```


```{r Grupping data}
require("dplyr")
group_by(df,alg, prob, n_vert) %>%
  summarise(
    count = n(),
    mean = mean(time, na.rm = TRUE),
    sd = sd(time, na.rm = TRUE)
  )

model.tables(res.aov1, type="means", se = TRUE)

```

# --------- Two-way interaction plot

```{r interaction plot}
interaction.plot(x.factor = df$alg, trace.factor = df$n_vert, 
                 response = df$time, fun = mean, 
                 type = "b", legend = TRUE, 
                 xlab = "algo", ylab="cpu_time",
                 pch=c(1,19), col = c("#00AFBB", "#E7B800"))

interaction.plot(x.factor = df$alg, trace.factor = df$prob, 
                 response = df$time, fun = mean, 
                 type = "b", legend = TRUE, 
                 xlab = "algo", ylab="cpu_time",
                 pch=c(1,19), col = c("#00AFBB", "#E7B800"))
```
# Normalidade plots ---------------

```{r Normalidade dos plots}
plot(res.aov1, 1)

res<-res.aov1$residuals

hist(res,main="Histogram of residuals",xlab="Residuals")

leveneTest(df$time~interaction(df$alg,df$prob),data=df)
```

# Post HOC Analysis ---------------

```{r Post HOC}
TukeyHSD(res.aov1)
plot(TukeyHSD(res.aov1, conf.level=.95), las = 2)
```

# -----------------